import {useEffect, useState} from 'react';
import {Link} from '@shopify/hydrogen/client';

import CartToggle from './CartToggle.client';
import {useCartUI} from './CartUIProvider.client';
import Navigation from './Navigation.client';
import MobileNavigation from './MobileNavigation.client';

/**
 * A client component that specifies the content of the header on the website
 */
export default function Header({collections, storeName}) {
  const [isMobileNavOpen, setIsMobileNavOpen] = useState(false);
  const [scrollbarWidth, setScrollbarWidth] = useState(0);
  const {isCartOpen} = useCartUI();

  useEffect(() => {
    const scrollbarWidth =
      window.innerWidth - document.documentElement.clientWidth;

    setScrollbarWidth(scrollbarWidth);
  }, [isCartOpen]);

  return (
    <header className="h-20 lg:h-32" role="banner">
      <div
        className={`fixed z-20 h-20 lg:h-32 w-full border-b border-gray-200 px-6 md:px-8 md:py-6 lg:pt-8 lg:pb-0 mx-auto bg-white ${
          isMobileNavOpen ? '' : 'bg-opacity-95'
        }`}
      >
        <div
          className="h-full flex lg:flex-col place-content-between"
          style={{
            paddingRight: isCartOpen ? scrollbarWidth : 0,
          }}
        >
          <div className="text-center w-full flex justify-between items-center">
            <MobileNavigation
              collections={collections}
              isOpen={isMobileNavOpen}
              setIsOpen={setIsMobileNavOpen}
            />
            <Link
              className="font-black uppercase text-3xl tracking-widest"
              to="/"
            >
              <svg
                aria-hidden="true"
                focusable="false"
                role="presentation"
                className="icon icon--wide icon_logo"
                viewBox="0 0 1000 280"
              >
                <g fill="white">
                  <path
                    className="st0"
                    d="M193.4 138.4h-11.8c-2.9 0-5.2-2.3-5.2-5.2V15.7c0-2.9 2.3-5.2 5.2-5.2h11.8c2.9 0 5.2 2.3 5.2 5.2v117.5c0 2.9-2.4 5.2-5.2 5.2zM109.6 202.6H11.9c-2 0-3.8-1.1-4.6-2.8-.9-1.7-.7-3.8.4-5.4l72.1-98.7H17.6c-2.9 0-5.2-2.3-5.2-5.2V79.9c0-2.9 2.3-5.2 5.2-5.2h94c2 0 3.8 1.1 4.6 2.8.9 1.7.7 3.8-.4 5.4l-72 98.7h65.8c2.9 0 5.2 2.3 5.2 5.2v10.5c0 3-2.3 5.3-5.2 5.3zM798.2 140.9c-6.9 0-13.7-1-20-2.9-16.9-5.1-29.1-18.5-33.3-35.6-4.1-16.5-1.9-35.7-1.9-52.5V22.5c0-2-.2-4.2 0-6.2.6-4.9 3.9-5.5 8.1-5.5 1.6 0 3.7-.2 5.8-.2 3.1 0 6.1.5 7.5 2.8 1 1.7.7 4 .7 5.8v54.4c0 6.3-.4 12.9.5 19.2 2.5 17.8 16.2 26.5 32.7 26.5 1.9 0 3.7-.1 5.7-.3 18.3-2.1 27.6-16.3 27.9-33.9.2-15.6 0-31.2 0-46.7 0-7.1-.3-14.2 0-21.2.2-5.6 4.8-6.6 9.6-6.6 2.6 0 5.2.3 7.4.3 4.1 0 5.1 3.5 5.2 6.8.5 17.5 0 35 0 52.5 0 5.2.1 10.5 0 15.7-.2 18.1-7.5 35.9-23 46-9.6 6.1-21.3 9-32.9 9zM312.3 204.5c-8.9 0-17.7-1.4-25.5-3.7-4.8-1.4-12.4-3.3-16.2-6.8-4.5-4.1-.4-8.5 2.4-12.3 2.4-3.2 4.5-6.1 8.2-6.1.7 0 1.6.1 2.4.4 5.2 1.5 9.6 4.3 15.1 5.5 4.5 1 9.3 1.7 14.1 1.7 6.4 0 12.9-1.1 18.5-4.1 7.6-3.9 14.4-14.1 7.1-21.7-6.5-6.7-19.2-7.7-27.7-9.5-11.1-2.3-23-4.9-32.2-12-16.1-12.4-16.4-36.3-2-50.2 10.1-9.7 24.4-13.2 38.6-13.2 6.6 0 13.1.8 19.1 2 5.6 1.2 25.4 4.7 25 12.5-.2 3.6-5.7 10.6-8.6 12.6-1.2.8-2.5 1.1-3.8 1.1-2.2 0-4.4-.8-6.3-1.5-7.8-3.1-16.4-4.9-25-4.9-2.3 0-4.6.1-6.8.4-7.6.9-17.8 4-20 12.4-2.9 11.2 10 14.9 18.2 16.9 12.2 3 24.7 5 36.2 10.3 20.4 9.3 27.5 33.1 13.7 51.5-10.5 13.5-27.5 18.7-44.5 18.7zm34.2-109.1zm.9 40.8s-1.2-.5-4.4-2c-1.6-.7-2.2-1-2.2-1s1.7.8 3.3 1.5c1.6.8 3.3 1.5 3.3 1.5zM463.2 269.1c-8.9 0-17.7-1.4-25.5-3.7-4.8-1.4-12.4-3.3-16.2-6.8-4.5-4.1-.4-8.5 2.4-12.3 2.4-3.2 4.5-6.1 8.2-6.1.7 0 1.6.1 2.4.4 5.2 1.5 9.6 4.3 15.1 5.5 4.5 1 9.3 1.7 14.1 1.7 6.4 0 12.9-1.1 18.5-4.1 7.6-3.9 14.4-14.1 7.1-21.7-6.5-6.7-19.2-7.7-27.7-9.5-11.1-2.3-23-4.9-32.2-12-16.1-12.4-16.4-36.3-2-50.2 10.1-9.7 24.4-13.2 38.6-13.2 6.6 0 13.1.8 19.1 2 5.7 1.2 25.4 4.7 25 12.5-.2 3.6-5.7 10.6-8.6 12.6-1.2.8-2.5 1.1-3.8 1.1-2.2 0-4.4-.8-6.3-1.5-7.8-3.1-16.4-4.9-25-4.9-2.3 0-4.6.1-6.8.4-7.6.9-17.8 4-20 12.5-2.9 11.2 10 14.9 18.2 16.9 12.2 3 24.7 5 36.2 10.3 20.4 9.3 27.5 33.1 13.7 51.5-10.5 13.4-27.5 18.6-44.5 18.6zM497.5 160zm.8 40.8s-1.2-.5-4.4-2c-1.6-.7-2.2-1-2.2-1s1.7.8 3.3 1.5c1.6.8 3.3 1.5 3.3 1.5zM630.9 203.8c-13.9 0-27.8-4.1-39.2-12.3-22.6-16.3-31.2-46.3-23.7-72.8 7.6-26.6 31.7-44.8 59.1-46.2 1.2-.1 2.4-.1 3.6-.1 26.2 0 50.5 14.8 60.8 39.4-.1-.3-.4-.9-.6-1.4-.4-.9-.7-1.8-.7-1.8s.4.9 1.5 3.6c0 2.9 2.5 7.1 3.1 10 .9 4.1 1.5 8.2 1.7 12.4.4 7.8-.4 15.6-2.6 23.1-4.1 14.1-13 26.5-25.1 34.8-11.1 7.5-24.5 11.3-37.9 11.3zm.3-109.7c-15.6 0-30.7 7.6-38.4 21.7-8.7 16-7.1 37.5 4.7 51.5 8.3 9.9 21 15 33.7 15 5.7 0 11.3-1 16.6-3.1 16.6-6.5 26.4-22.4 26.8-39.9v-1.2-1.9.7c-.6-20.8-14.3-38.8-35.4-42.3-2.6-.2-5.3-.5-8-.5zm43.5 45.4v-1.1-1.2 2.3zM754.1 215.3h-11.4v-32.6h11.4c9.5 0 16.6 6.8 16.6 16.3 0 9.4-7.2 16.3-16.6 16.3zm-6.2-27.6v22.5h6.2c6.6 0 11.3-4.6 11.3-11.3 0-6.6-4.8-11.3-11.3-11.3h-6.2v.1zM806.4 215.8c-9.5 0-16.9-7.3-16.9-16.8 0-9.6 7.3-16.8 16.9-16.8 9.5 0 16.8 7.3 16.9 16.8-.1 9.6-7.4 16.8-16.9 16.8zm0-28.6c-6.6 0-11.6 5-11.6 11.8 0 6.8 5 11.8 11.6 11.8s11.5-5 11.5-11.8c0-6.8-5-11.8-11.5-11.8zM869.5 215.3H863l-9.3-12.1h-5v12.1h-5.3v-32.6h13.4c7.1 0 11.1 4.2 11.1 10.3 0 5.4-3 8.8-8.2 9.8l9.8 12.5zm-20.8-27.6v10.7h7.6c4.3 0 6.3-2.2 6.3-5.4s-2.1-5.3-6.3-5.3h-7.6zM919.5 215.3h-5.2v-25.5L904.2 205h-.5l-10-15.2v25.5h-5.2v-32.6h6.1l9.4 14 9.3-14h6.2v32.6zM946.4 215.3h-5.3v-32.6h5.3v32.6zM994 215.3h-6.5l-9.3-12.1h-5v12.1H968v-32.6h13.4c7.1 0 11.1 4.2 11.1 10.3 0 5.4-3 8.8-8.2 9.8l9.7 12.5zm-20.8-27.6v10.7h7.6c4.3 0 6.3-2.2 6.3-5.4s-2-5.3-6.3-5.3h-7.6zM751.9 266.9c-6.2 0-11.2-2.9-11.2-9 0-4.2 2.6-6.4 6.8-8.9-2.6-3.3-3.4-5.3-3.4-7.5 0-5.4 4.4-8.2 9.2-8.2 4.8 0 8.8 2.9 8.8 7.9 0 4.2-3.1 6.6-7.1 9.1 1.6 1.7 3.6 3.8 6.1 6.4.7-1.4 1.3-3.1 1.6-5.2h5.3c-.4 3.3-1.5 6.4-3.3 8.9 1.7 1.8 3.6 3.8 5.7 6h-6.6c-.8-.9-1.7-1.7-2.4-2.5-2.5 1.8-5.8 3-9.5 3zm-1.1-14.2c-3.2 1.9-4.7 3-4.7 5.1 0 2.6 2.1 4.3 6.2 4.3 2.1 0 4-.6 5.7-1.8-3-3.1-5.3-5.5-7.2-7.6zm2.4-14.6c-2.2 0-3.8 1.3-3.8 3.7 0 1.3.6 2.6 2.3 4.8 3.8-2.3 5-3.5 5-5.4.1-1.8-1.2-3.1-3.5-3.1zM823.6 266.4h-6.7l-11.2-32.6h5.6l8.9 26.5 9-26.5h5.6l-11.2 32.6zM859.3 266.4H854v-32.6h5.3v32.6zM896.3 266.4h-6.7l-11.1-32.6h5.5l9 26.5 8.9-26.5h5.6l-11.2 32.6zM948 266.4h-21.3v-32.6H948v5h-16v8.4h14.8v5.1H932v9h16v5.1zM994 266.4h-6.5l-9.3-12.1h-5v12.1H968v-32.6h13.4c7.1 0 11.1 4.2 11.1 10.3 0 5.3-3 8.8-8.2 9.8l9.7 12.5zm-20.8-27.6v10.7h7.6c4.3 0 6.3-2.2 6.3-5.4s-2-5.3-6.3-5.3h-7.6z"
                  ></path>
                </g>
              </svg>
            </Link>
            <Navigation collections={collections} storeName={storeName} />
            <CartToggle
              handleClick={() => {
                if (isMobileNavOpen) setIsMobileNavOpen(false);
              }}
            />
          </div>
        </div>
      </div>
    </header>
  );
}
